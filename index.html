<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø§Ø±ÙƒØ¶ ÙˆØ§Ø±Ø¨Ø­</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:linear-gradient(#0f2027,#203a43,#2c5364);
  font-family:Arial;
  color:#fff;
  text-align:center;
}
#game{
  width:100%;
  max-width:420px;
  height:240px;
  margin:15px auto;
  background:linear-gradient(#87ceeb,#cceeff);
  border-radius:16px;
  border:2px solid #ff2a2a;
  position:relative;
  overflow:hidden;
}
#ground{
  position:absolute;
  bottom:0;
  width:200%;
  height:35px;
  background:repeating-linear-gradient(
    90deg,#4b5320 0 30px,#5f6f1f 30px 60px
  );
}
#player{
  position:absolute;
  left:50px;
  bottom:35px;
  width:34px;
  height:34px;
  background:radial-gradient(circle at 30% 30%,#00ffcc,#008080);
  border-radius:50%;
}
.cloud{
  position:absolute;
  top:30px;
  width:60px;
  height:25px;
  background:#fff;
  border-radius:50px;
  opacity:.8;
}
.obstacle{
  position:absolute;
  bottom:35px;
  width:26px;
  height:42px;
  background:linear-gradient(#ff5555,#aa0000);
  border-radius:8px;
}
button,input{
  padding:10px 20px;
  margin:5px;
  border:none;
  border-radius:8px;
  font-size:15px;
}
button{background:#ff2a2a;color:white}
#panel{
  background:#111;
  padding:10px;
  border-radius:12px;
  max-width:420px;
  margin:auto;
}
#msg{margin-top:8px;font-size:18px}
</style>
</head>

<body>

<h2>ğŸƒâ€â™‚ï¸ Ø§Ø±ÙƒØ¶ ÙˆØ§Ø±Ø¨Ø­</h2>
<p>Ø§Ù„Ù…Ø³Ø§ÙØ©: <span id="score">0</span> | Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: <span id="tries">3</span></p>

<div id="game">
  <div class="cloud" style="left:300px"></div>
  <div class="cloud" style="top:60px;left:150px;width:40px"></div>
  <div id="ground"></div>
  <div id="player"></div>
</div>

<div id="panel">
  <button onclick="jump()">Ù‚ÙØ²</button>
  <button onclick="restart()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</button>
  <br>
  <input id="code" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø´Ø­Ù†">
  <button onclick="charge()">Ø´Ø­Ù† Ù…Ø­Ø§ÙˆÙ„Ø§Øª</button>
</div>

<div id="msg"></div>

<script>
// ====== ØµÙˆØª ======
const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
function beep(freq,dur){
  let o=audioCtx.createOscillator();
  let g=audioCtx.createGain();
  o.frequency.value=freq;
  o.connect(g); g.connect(audioCtx.destination);
  o.start();
  g.gain.exponentialRampToValueAtTime(0.0001,audioCtx.currentTime+dur);
  o.stop(audioCtx.currentTime+dur);
}

// ====== Ø¹Ù†Ø§ØµØ± ======
const game=document.getElementById("game");
const player=document.getElementById("player");
const ground=document.getElementById("ground");
const clouds=document.querySelectorAll(".cloud");
const scoreEl=document.getElementById("score");
const triesEl=document.getElementById("tries");
const msg=document.getElementById("msg");

// ====== Ù…ØªØºÙŠØ±Ø§Øª ======
let y=0,v=0,gravity=0.8,jumping=false;
let speed=4,score=0,gameOver=false;
let obstacles=[];
let distance=0,minDistance=240;
let tries=3;

// ====== Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø´Ø­Ù† ======
const codes={
  "SHAM5":5,
  "SHAM10":12,
  "SHAM20":30
};

// ====== ØªØ­ÙƒÙ… ======
function jump(){
  if(jumping||gameOver) return;
  v=13; jumping=true;
  beep(600,0.15); // ØµÙˆØª Ù‚ÙØ²
}
function restart(){
  if(tries<=0){
    msg.innerText="âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§ØªØŒ Ø§Ø´Ø­Ù†!";
    return;
  }
  tries--;
  triesEl.innerText=tries;
  obstacles.forEach(o=>o.remove());
  obstacles=[];
  score=0; speed=4; y=0; v=0;
  distance=0; gameOver=false;
  msg.innerText="";
  scoreEl.innerText=0;
}
function charge(){
  let c=document.getElementById("code").value.trim();
  if(codes[c]){
    tries+=codes[c];
    triesEl.innerText=tries;
    msg.innerText="âœ… ØªÙ… Ø´Ø­Ù† "+codes[c]+" Ù…Ø­Ø§ÙˆÙ„Ø©";
    delete codes[c];
  }else{
    msg.innerText="âŒ ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­";
  }
}

// ====== Ù„ÙˆØ¨ Ø§Ù„Ù„Ø¹Ø¨Ø© ======
setInterval(()=>{
  if(gameOver) return;

  // Ù„Ø§Ø¹Ø¨
  v-=gravity; y+=v;
  if(y<=0){y=0;v=0;jumping=false;}
  player.style.bottom=(35+y)+"px";

  // Ø£Ø±Ø¶
  ground.style.left=(ground.offsetLeft-speed)+"px";
  if(ground.offsetLeft<=-game.offsetWidth) ground.style.left="0px";

  // ØºÙŠÙˆÙ…
  clouds.forEach(c=>{
    c.style.left=(c.offsetLeft-speed*0.3)+"px";
    if(c.offsetLeft<-80) c.style.left=game.offsetWidth+"px";
  });

  // ØªÙˆÙ„ÙŠØ¯ Ø¹ÙˆØ§Ø¦Ù‚
  distance+=speed;
  if(distance>minDistance){
    let o=document.createElement("div");
    o.className="obstacle";
    o.style.right="-40px";
    game.appendChild(o);
    obstacles.push(o);
    distance=0;
    minDistance=200+Math.random()*140;
  }

  // Ø­Ø±ÙƒØ© + ØªØµØ§Ø¯Ù…
  obstacles.forEach((o,i)=>{
    o.style.right=(parseInt(o.style.right)+speed)+"px";
    let r1=player.getBoundingClientRect();
    let r2=o.getBoundingClientRect();
    if(!(r1.right<r2.left||r1.left>r2.right||r1.bottom<r2.top||r1.top>r2.bottom)){
      beep(200,0.3); // ØµÙˆØª Ø§ØµØ·Ø¯Ø§Ù…
      msg.innerText="âŒ Ø®Ø³Ø±Øª!";
      gameOver=true;
    }
    if(o.offsetLeft<-60){
      o.remove(); obstacles.splice(i,1);
      score+=10; scoreEl.innerText=score;

      // ğŸ”¥ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØµØ¹ÙˆØ¨Ø© ØªØ¯Ø±ÙŠØ¬ÙŠÙ‹Ø§
      if(score%100===0){
        speed+=0.3;
        gravity+=0.02;
      }
      if(score>=700){
        msg.innerText="ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ Ø±Ø¨Ø­Øª!";
        gameOver=true;
      }
    }
  });

},30);
</script>

</body>
</html>
